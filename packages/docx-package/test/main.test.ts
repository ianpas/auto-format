import { resolve } from "path";
import { LoadPackage, SavePackage } from "./utility";

test("read document", async () =>
{
    const __package = await LoadPackage(resolve(__dirname, "./common/chapter-section.docx"));
    expect(await __package.Read("document")).toEqual(`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:cx="http://schemas.microsoft.com/office/drawing/2014/chartex" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:w15="http://schemas.microsoft.com/office/word/2012/wordml" xmlns:w16se="http://schemas.microsoft.com/office/word/2015/wordml/symex" xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape" mc:Ignorable="w14 w15 w16se wp14"><w:body><w:p w:rsidR="007342FB" w:rsidRPr="000C2C82" w:rsidRDefault="000A0944" w:rsidP="000C2C82"><w:pPr><w:pStyle w:val="1"/><w:jc w:val="center"/></w:pPr><w:r w:rsidRPr="000C2C82"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t xml:space="preserve">第一章 </w:t></w:r><w:r w:rsidR="003D6E9C" w:rsidRPr="000C2C82"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>绪论</w:t></w:r></w:p><w:p w:rsidR="000A0944" w:rsidRDefault="000A0944" w:rsidP="006F5204"><w:pPr><w:pStyle w:val="2"/></w:pPr><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>1.1</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>简述</w:t></w:r></w:p><w:p w:rsidR="003C5A4F" w:rsidRPr="003C5A4F" w:rsidRDefault="003C5A4F" w:rsidP="003C5A4F"><w:pPr><w:ind w:firstLine="420"/></w:pPr><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>本Wo</w:t></w:r><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>rd为北航学位论文模板，适用于理工类博士、学术硕士和专业硕士（需作相应调整，详见第四章）。本Word模板参考自2015年8月版北航《研究生手册》（以下简称《手册》），具体要求请参见各自的《手册》，后续版本格式变更请自行修改调整，最终成文格式需参考学院要求及打印方意见。本模板中大量内容和说明直接摘抄自《手册》（2015年8月版），基本覆盖了论文内容和格式方面的要求。</w:t></w:r></w:p><w:p w:rsidR="006F5204" w:rsidRDefault="003C5A4F" w:rsidP="008A19A5"><w:pPr><w:ind w:firstLine="420"/></w:pPr><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>本模板已上传GitHub</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:t>，</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>该仓库中同时也包含了相应的</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:t>L</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>a</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:t>TeX</w:t></w:r><w:r w:rsidRPr="003C5A4F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>模板。</w:t></w:r></w:p><w:p w:rsidR="00394D62" w:rsidRDefault="00394D62" w:rsidP="00394D62"><w:pPr><w:pStyle w:val="2"/></w:pPr><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>1.2</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>概述</w:t></w:r></w:p><w:p w:rsidR="00EB353E" w:rsidRPr="00EB353E" w:rsidRDefault="00394D62" w:rsidP="00EB353E"><w:r w:rsidRPr="00EB353E"><w:tab/></w:r><w:r w:rsidR="00EB353E" w:rsidRPr="00EB353E"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>学位论文是标明作者从事科学研究取得的创造性成果和创新见解，并以此为内容撰写的、作为申请学位时评审用的学位论文。</w:t></w:r></w:p><w:p w:rsidR="00EB353E" w:rsidRPr="00EB353E" w:rsidRDefault="00EB353E" w:rsidP="00EB353E"><w:pPr><w:ind w:firstLine="420"/></w:pPr><w:r w:rsidRPr="00EB353E"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>硕士学位论文应该表明作者在本门学科上掌握了坚实的基础理论和系统的专门知识，对所研究的课题有新的见解，并具有从事科学研究工作或独立担任专门技术工作能力。</w:t></w:r></w:p><w:p w:rsidR="00394D62" w:rsidRDefault="00EB353E" w:rsidP="00EB353E"><w:pPr><w:ind w:firstLine="420"/></w:pPr><w:r w:rsidRPr="00EB353E"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>博士学位论文应表明作者在本门学科上掌握了坚实广阔的基础理论和系统深入的专门知识，在科学和专门技术上做出了创造性的成果，并具有独立从事科学研究工作能力。</w:t></w:r></w:p><w:p w:rsidR="0097291F" w:rsidRDefault="0097291F" w:rsidP="00EB353E"><w:pPr><w:ind w:firstLine="420"/></w:pPr></w:p><w:p w:rsidR="0097291F" w:rsidRPr="000A0944" w:rsidRDefault="0097291F" w:rsidP="0097291F"><w:pPr><w:pStyle w:val="1"/><w:jc w:val="center"/></w:pPr><w:r w:rsidRPr="000A0944"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>第</w:t></w:r><w:r w:rsidR="00A43FF2"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>二</w:t></w:r><w:r w:rsidRPr="000A0944"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t xml:space="preserve">章 </w:t></w:r><w:r w:rsidR="00A7459F"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>要求</w:t></w:r></w:p><w:p w:rsidR="0097291F" w:rsidRDefault="0097291F" w:rsidP="0097291F"><w:pPr><w:pStyle w:val="2"/></w:pPr><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>1.1</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r w:rsidR="00AC14FE"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>概述</w:t></w:r></w:p><w:p w:rsidR="00665CF1" w:rsidRPr="00665CF1" w:rsidRDefault="00665CF1" w:rsidP="00665CF1"><w:pPr><w:ind w:firstLine="420"/></w:pPr><w:r w:rsidRPr="00665CF1"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t xml:space="preserve">保密审批通过论文需在封面、题名页直接把相应的“密级☆”及“保密期限”表注在右上角（非密论文务必将相应内容清除），并将《涉密论文审批通知》复印件附在论文最后。密级按由低到高可分为“秘密”，“机密”，“绝密”三级，保密期限可分为“3年”，“5年”，“10年”、“永久”，例如“密级☆ </w:t></w:r><w:r w:rsidRPr="00665CF1"><w:t>5年</w:t></w:r><w:r w:rsidRPr="00665CF1"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>”。鼓励尽量对学位论文进行去密处理；</w:t></w:r></w:p><w:p w:rsidR="0097291F" w:rsidRDefault="0097291F" w:rsidP="0097291F"><w:pPr><w:pStyle w:val="2"/></w:pPr><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>1.2</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>概述</w:t></w:r><w:r w:rsidR="00AE107B"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>2</w:t></w:r></w:p><w:p w:rsidR="0097291F" w:rsidRPr="006E5E17" w:rsidRDefault="0097291F" w:rsidP="006E5E17"><w:r w:rsidRPr="00EB353E"><w:tab/></w:r><w:r w:rsidR="006E5E17" w:rsidRPr="006E5E17"><w:rPr><w:rFonts w:hint="eastAsia"/></w:rPr><w:t>以国务院学位委员会批准的授予博士、硕士学位和培养研究生的学科、专业目录中的学科专业为准，一般为二级学科。对专业学位应填相应的工程领域（如航空工程）或专业学位（工商管理硕士）名称；</w:t></w:r></w:p><w:sectPr w:rsidR="0097291F" w:rsidRPr="006E5E17"><w:pgSz w:w="11906" w:h="16838"/><w:pgMar w:top="1440" w:right="1800" w:bottom="1440" w:left="1800" w:header="720" w:footer="720" w:gutter="0"/><w:cols w:space="720"/><w:docGrid w:type="lines" w:linePitch="312"/></w:sectPr></w:body></w:document>`);
});

test("save document", async () =>
{
    const __package = await LoadPackage(resolve(__dirname, "./common/replace-document.docx"));

    const content = "test";
    __package.Save({ content, name: "document" });
    expect(await __package.Read("document")).toEqual(content);
});


test("save docx", async () =>
{

    const __package = await LoadPackage(resolve(__dirname, "./common/replace-document.docx"));

    const content = "test";
    await SavePackage(resolve(__dirname, "./common/save-docx.docx"), __package.Save({ content, name: "document" }));

    {
        const __package = await LoadPackage(resolve(__dirname, "./common/save-docx.docx"));
        expect(await __package.Read("document")).toEqual(content);
    }
});